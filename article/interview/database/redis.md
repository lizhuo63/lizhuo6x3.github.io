# Redis

### 缓存击穿

指访问的单条数据在redis中没有但DB中有（一般是缓存时间到期）。会引起数据库压力瞬间增大。若击穿的数据过多，就会诱发**缓存雪崩**，缓存雪崩是不同数据都过期了，很多数据都查不到从而查数据库。

**解决：**

1. 设置热点数据永远不过期
2. 对热点数据做预热

### 缓存穿透

指访问的单条数据在redis和DB中都没有，导致所有的请求都落到数据库上，造成数据库短时间内承受大量请求而崩掉。

**解决：** 

1.  **接口层增加校验**，如用户鉴权校验，id做基础校验，id<=0的直接拦截；
2.  采用**Bitmap和布隆过滤器**，将所有存在的数据哈希到一个bitmap中，bitmap会拦截不存在的数据，从而避免了对DB查询压力附加。

### 布隆过滤器

为Redis 提供强大的去重功能。相比于 Set 集合的去重功能而言，布隆过滤器在空间上能节省 90% 以上，但是它有 1% 左右的误判率。这种误判率，在处理海量数据时，几乎可以忽略。

**原理：**它由一个位数组和一系列哈希函数两部分组成。通过`exists()`来判断某个元素是否存在于。当布隆过滤器判定存在，该值只是有可能存在；当判断不存在时，该值必然不存在，这个误判概率大约在 1% 左右。